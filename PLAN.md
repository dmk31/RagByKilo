# План разработки модуля ChromaDBManager

Этот план описывает шаги по созданию объектно-ориентированной обёртки для ChromaDB на Python.

## TODO

- [x] 1.  **Создание структуры проекта:**
    -   [x] Создать директорию `src`.
    -   [x] Создать файл `src/__init__.py`.
    -   [x] Создать файл `src/chroma_manager.py` для основного класса.
    -   [x] Создать директорию `datasets_chroma` для хранения данных.
    -   [x] Создать файл `main.py` в корне проекта для демонстрации работы.
    -   [x] Создать файл `.env` с переменной `CHROMA_DB_PATH=./datasets_chroma`.
    -   [x] Создать файл `requirements.txt` с зависимостями: `chromadb`, `python-dotenv`, `langchain`.
    -   [x] Создать файл `README.md`.

- [x] 2.  **Реализация класса `ChromaDBManager` в `src/chroma_manager.py`:**
    -   [x] **Инициализация (`__init__`):**
        -   [x] Загрузка переменных из `.env` с помощью `python-dotenv`.
        -   [x] Инициализация клиента ChromaDB (`chromadb.PersistentClient`) с путём из `.env`.
        -   [x] Обработка исключений при инициализации.
    -   [x] **Управление коллекциями:**
        -   [x] `get_or_create_collection(name)`: создание или получение коллекции.
        -   [x] `delete_collection(name)`: удаление коллекции.
        -   [x] `list_collections()`: получение списка всех коллекций.
    -   [x] **Индексация данных (`add_texts`):**
        -   [x] Приём имени коллекции и списка текстов.
        -   [x] Реализация разбиения текстов на чанки с помощью `RecursiveCharacterTextSplitter`.
        -   [x] Генерация детерминированных ID для чанков (на основе хэша).
        -   [x] Проверка на дубликаты перед добавлением через `upsert`.
        -   [x] Добавление метаданных к чанкам.
    -   [x] **Удаление данных:**
        -   [x] `delete_by_ids(collection_name, ids)`: удаление по списку ID.
        -   [x] `delete_by_source(collection_name, source_name)`: удаление всех чанков, связанных с источником.
    -   [x] **Поиск (`query_collection`):**
        -   [x] Реализация семантического поиска по текстовому запросу.
        -   [x] Возврат `n_results` наиболее релевантных результатов.
    -   [x] **Вспомогательные методы:**
        -   [x] `count_items(collection_name)`: подсчёт элементов в коллекции.
        -   [x] `peek_collection(collection_name, n)`: просмотр `n` элементов.
    -   [x] **Документирование и комментарии:**
        -   [x] Добавление docstrings в стиле Google ко всем методам.
        -   [x] Подробные комментарии на русском языке к ключевым алгоритмам.

- [x] 3.  **Создание примера использования в `main.py`:**
    -   [x] Демонстрация создания экземпляра `ChromaDBManager`.
    -   [x] Пример создания коллекции.
    -   [x] Пример добавления текстов (`add_texts`).
    -   [x] Пример поиска (`query_collection`).
    -   [x] Пример вывода результатов.
    -   [x] Пример удаления данных.

- [x] 4.  **Заполнение `README.md`:**
    -   [x] Краткое описание проекта.
    -   [x] Инструкции по установке и запуску.
    -   [x] Пример использования.

- [x] 5.  **Финальное ревью и переход к реализации:**
    -   [x] Обсуждение и утверждение плана.
    -   [x] Переход в режим "Код" для написания кода.